{"ast":null,"code":"import _slicedToArray from\"/root/hw-milestone/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import classes from\"../css/CommentForm.module.css\";import SumbitButton from\"../../ui/js/SumbitButton\";import LoginErrorDialog from\"../../ui/js/LoginErrorDialog\";import Backdrop from\"../../ui/js/Backdrop\";import{useState}from'react';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function CommentForm(props){var navigate=useNavigate();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),comment_text=_useState2[0],setCommentText=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),rating=_useState4[0],setRating=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),IsErrorDialogOpen=_useState6[0],setIsErrorDialogOpen=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isRedirecting=_useState8[0],setisRedirecting=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),dialogMessage=_useState10[0],setDialogMessage=_useState10[1];function setComment(text){console.log(text.target.value);setCommentText(text.target.value);}function showCloseHandler(){setIsErrorDialogOpen(true);}function hideCloseHandler(){setIsErrorDialogOpen(false);}function postComment(){var requestOptions={method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({comment:comment_text,rating:rating})};fetch(\"/post/\"+props.movie_id+\"/\"+props.user+\"\",requestOptions).then(function(reponse){return reponse.json().then(function(data){if(data.comment_posted_success==true){setDialogMessage([\"Comment failed to post. Please try again later.\"]);showCloseHandler();}else{setDialogMessage([\"Comment posted successfully. Refresh to update comments\"]);showCloseHandler();setisRedirecting(true);}});});}return/*#__PURE__*/_jsxs(\"div\",{className:classes.commentform,children:[/*#__PURE__*/_jsx(\"div\",{className:classes.commentlogo,children:\"Create a New Comment\"}),/*#__PURE__*/_jsx(\"form\",{children:/*#__PURE__*/_jsx(\"textarea\",{type:\"text\",style:{resize:'none'},className:classes.commentbox,onChange:setComment})}),/*#__PURE__*/_jsxs(\"div\",{className:classes.commentoptions,type:\"submit\",onChange:setRating,children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Movie ID: \",props.movie_id]}),/*#__PURE__*/_jsx(\"div\",{children:\"Rating (out of 5)\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"rating\",onChange:setRating,children:[/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"1\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2\",children:\"2\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3\",children:\"3\"}),/*#__PURE__*/_jsx(\"option\",{value:\"4\",children:\"4\"}),/*#__PURE__*/_jsx(\"option\",{value:\"5\",children:\"5\"})]}),/*#__PURE__*/_jsx(SumbitButton,{onClick:postComment})]}),IsErrorDialogOpen&&/*#__PURE__*/_jsx(LoginErrorDialog,{onCancel:hideCloseHandler,message:dialogMessage}),IsErrorDialogOpen&&/*#__PURE__*/_jsx(Backdrop,{onClick:hideCloseHandler})]});}export default CommentForm;","map":{"version":3,"sources":["/root/hw-milestone/src/components/comments/js/CommentForm.js"],"names":["classes","SumbitButton","LoginErrorDialog","Backdrop","useState","useNavigate","CommentForm","props","navigate","comment_text","setCommentText","rating","setRating","IsErrorDialogOpen","setIsErrorDialogOpen","isRedirecting","setisRedirecting","dialogMessage","setDialogMessage","setComment","text","console","log","target","value","showCloseHandler","hideCloseHandler","postComment","requestOptions","method","headers","body","JSON","stringify","comment","fetch","movie_id","user","then","reponse","json","data","comment_posted_success","commentform","commentlogo","resize","commentbox","commentoptions"],"mappings":"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","sourcesContent":["import classes from \"../css/CommentForm.module.css\"\nimport SumbitButton from \"../../ui/js/SumbitButton\";\nimport LoginErrorDialog from \"../../ui/js/LoginErrorDialog\";\nimport Backdrop from \"../../ui/js/Backdrop\";\nimport { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\n\nfunction CommentForm(props) {\n\n\n\n    let navigate = useNavigate();\n\n    const [comment_text, setCommentText] = useState(\"\");\n\n    const [rating, setRating] = useState(\"\");\n\n    const [IsErrorDialogOpen, setIsErrorDialogOpen] = useState(false);\n\n    const [isRedirecting, setisRedirecting] = useState(false);\n\n    const [dialogMessage, setDialogMessage] = useState(\"\");\n\n    function setComment(text) {\n        console.log(text.target.value)\n        setCommentText(text.target.value);\n    }\n\n\n    function showCloseHandler() {\n        setIsErrorDialogOpen(true);\n\n    }\n\n    function hideCloseHandler() {\n        setIsErrorDialogOpen(false);\n\n    }\n\n    function postComment() {\n        const requestOptions = {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ comment: comment_text, rating: rating })\n        };\n        fetch(\"/post/\" + props.movie_id + \"/\" + props.user + \"\", requestOptions).then(reponse =>\n            reponse.json().then(data => {\n\n                if (data.comment_posted_success == true) {\n                    setDialogMessage([\"Comment failed to post. Please try again later.\"])\n                    showCloseHandler();\n                } else {\n                    setDialogMessage([\"Comment posted successfully. Refresh to update comments\"])\n                    showCloseHandler();\n                    setisRedirecting(true);\n                }\n            }\n            )\n        )\n    }\n\n    return (\n        <div className={classes.commentform}>\n            <div className={classes.commentlogo}>\n                Create a New Comment\n            </div>\n            <form>\n                <textarea type=\"text\"\n                    style={{ resize: 'none' }}\n                    className={classes.commentbox}\n                    onChange={setComment}\n\n                />\n\n            </form>\n            <div className={classes.commentoptions} type=\"submit\" onChange={setRating}>\n                <div>Movie ID: {props.movie_id}</div>\n                <div>Rating (out of 5)</div>\n                <select name=\"rating\" onChange={setRating}>\n                    <option value=\"1\">1</option>\n                    <option value=\"2\">2</option>\n                    <option value=\"3\">3</option>\n                    <option value=\"4\">4</option>\n                    <option value=\"5\">5</option>\n                </select>\n                <SumbitButton onClick={postComment} />\n            </div>\n            {IsErrorDialogOpen && <LoginErrorDialog\n                onCancel={hideCloseHandler}\n                message={dialogMessage} />}\n            {IsErrorDialogOpen && <Backdrop onClick={hideCloseHandler} />}\n        </div>\n    );\n}\n\nexport default CommentForm"]},"metadata":{},"sourceType":"module"}