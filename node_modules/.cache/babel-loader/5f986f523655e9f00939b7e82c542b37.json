{"ast":null,"code":"import _slicedToArray from\"/root/hw-milestone/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import classes from\"../css/CommentForm.module.css\";import SumbitButton from\"../../ui/js/SumbitButton\";import{useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function CommentForm(props){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),comment_text=_useState2[0],setCommentText=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),rating=_useState4[0],setRating=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),IsErrorDialogOpen=_useState6[0],setIsErrorDialogOpen=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isRedirecting=_useState8[0],setisRedirecting=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),dialogMessage=_useState10[0],setDialogMessage=_useState10[1];function setComment(text){setCommentText(text.target.value);}function showCloseHandler(){setIsErrorDialogOpen(true);}function hideCloseHandler(){setIsErrorDialogOpen(false);}function redirectBackToPage(){navigate(\"/movie/\"+props.user+\"/id?movie_page_id\"+props.movie_id);}function postComment(){var requestOptions={method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({comment:comment_text,rating:rating})};fetch(\"/post/\"+props.movie_id+\"/\"+props.user+\"\",requestOptions).then(function(reponse){return reponse.json().then(function(data){if(data.comment_posted_success==true){setDialogMessage([\"Comment failed to post. Please try again later.\"]);showCloseHandler();}else{setDialogMessage([\"Comment posted successfully.\"]);showCloseHandler();setisRedirecting(true);}});});}return/*#__PURE__*/_jsxs(\"div\",{className:classes.commentform,children:[/*#__PURE__*/_jsx(\"div\",{className:classes.commentlogo,children:\"Create a New Comment\"}),/*#__PURE__*/_jsx(\"form\",{children:/*#__PURE__*/_jsx(\"textarea\",{type:\"text\",style:{resize:'none'},className:classes.commentbox,onChange:setComment,onKeyPress:function onKeyPress(event){if(event.key=='Enter'&&userNameText!==\"\"){postComment();}}})}),/*#__PURE__*/_jsxs(\"div\",{className:classes.commentoptions,type:\"submit\",onChange:setRating,children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Movie ID: \",props.movie_id]}),/*#__PURE__*/_jsx(\"div\",{children:\"Rating (out of 5)\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"rating\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"1\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2\",children:\"2\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3\",children:\"3\"}),/*#__PURE__*/_jsx(\"option\",{value:\"4\",children:\"4\"}),/*#__PURE__*/_jsx(\"option\",{value:\"5\",children:\"5\"})]}),/*#__PURE__*/_jsx(SumbitButton,{})]}),IsErrorDialogOpen&&/*#__PURE__*/_jsx(LoginErrorDialog,{onCancel:hideCloseHandler,message:dialogMessage,onRedirect:redirectBackToPage,isRedirect:isRedirecting}),IsErrorDialogOpen&&/*#__PURE__*/_jsx(Backdrop,{onClick:hideCloseHandler})]});}export default CommentForm;","map":{"version":3,"sources":["/root/hw-milestone/src/components/comments/js/CommentForm.js"],"names":["classes","SumbitButton","useState","CommentForm","props","comment_text","setCommentText","rating","setRating","IsErrorDialogOpen","setIsErrorDialogOpen","isRedirecting","setisRedirecting","dialogMessage","setDialogMessage","setComment","text","target","value","showCloseHandler","hideCloseHandler","redirectBackToPage","navigate","user","movie_id","postComment","requestOptions","method","headers","body","JSON","stringify","comment","fetch","then","reponse","json","data","comment_posted_success","commentform","commentlogo","resize","commentbox","event","key","userNameText","commentoptions"],"mappings":"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","sourcesContent":["import classes from \"../css/CommentForm.module.css\"\nimport SumbitButton from \"../../ui/js/SumbitButton\";\nimport { useState } from 'react';\n\nfunction CommentForm(props) {\n\n    const [comment_text, setCommentText] = useState(\"\");\n\n    const [rating, setRating] = useState(\"\");\n\n    const [IsErrorDialogOpen, setIsErrorDialogOpen] = useState(false);\n\n    const [isRedirecting, setisRedirecting] = useState(false);\n\n    const [dialogMessage, setDialogMessage] = useState(\"\");\n\n    function setComment(text) {\n        setCommentText(text.target.value);\n    }\n\n\n    function showCloseHandler() {\n        setIsErrorDialogOpen(true);\n\n    }\n\n    function hideCloseHandler() {\n        setIsErrorDialogOpen(false);\n\n    }\n\n    function redirectBackToPage() {\n        navigate(\"/movie/\" + props.user + \"/id?movie_page_id\" + props.movie_id);\n    }\n    function postComment() {\n        const requestOptions = {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ comment: comment_text, rating: rating })\n        };\n        fetch(\"/post/\" + props.movie_id + \"/\" + props.user + \"\", requestOptions).then(reponse =>\n            reponse.json().then(data => {\n\n                if (data.comment_posted_success == true) {\n                    setDialogMessage([\"Comment failed to post. Please try again later.\"])\n                    showCloseHandler();\n                } else {\n                    setDialogMessage([\"Comment posted successfully.\"])\n                    showCloseHandler();\n                    setisRedirecting(true);\n                }\n            }\n            )\n        )\n    }\n\n    return (\n        <div className={classes.commentform}>\n            <div className={classes.commentlogo}>\n                Create a New Comment\n            </div>\n            <form>\n                <textarea type=\"text\"\n                    style={{ resize: 'none' }}\n                    className={classes.commentbox}\n                    onChange={setComment}\n                    onKeyPress={event => {\n                        if (event.key == 'Enter' && userNameText !== \"\") {\n                            postComment();\n                        }\n                    }\n                    }\n                />\n\n            </form>\n            <div className={classes.commentoptions} type=\"submit\" onChange={setRating}>\n                <div>Movie ID: {props.movie_id}</div>\n                <div>Rating (out of 5)</div>\n                <select name=\"rating\" >\n                    <option value=\"1\">1</option>\n                    <option value=\"2\">2</option>\n                    <option value=\"3\">3</option>\n                    <option value=\"4\">4</option>\n                    <option value=\"5\">5</option>\n                </select>\n                <SumbitButton />\n            </div>\n            {IsErrorDialogOpen && <LoginErrorDialog\n                onCancel={hideCloseHandler}\n                message={dialogMessage}\n                onRedirect={redirectBackToPage}\n                isRedirect={isRedirecting} />}\n            {IsErrorDialogOpen && <Backdrop onClick={hideCloseHandler} />}\n        </div>\n    );\n}\n\nexport default CommentForm"]},"metadata":{},"sourceType":"module"}